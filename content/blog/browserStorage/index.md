---
title: 웹 브라우저 저장공간
date: "2023-07-28T22:27:00.000Z"
description: "쿠키와 웹 스토리(세션/로컬)"
---

# 웹 브라우저 저장 공간

## **어디에 저장해야하는가?**

우리가 웹 브라우저에서 선택할 수 있는 저장소들에 대해 살펴보겠습니다.

### **쿠키**

서버가 클라이언트에 보내서 브라우저에 저장했다가, 클라이언트에서 추가적인 요청이 있을 때 다시 서버로 보내주는 문자열 정보입니다. 서버와 클라이언트는 HTTP 요청 시에 연결되었다가 응답이 완료되면 해제됩니다. 따라서 지속적으로 로그인 상태를 유지하거나 하는 작업을 하기 위해서는 로그인 여부를 판단할 수 있는 인증 토큰을 잠시 브라우저 쿠키에 저장해놓았다가, 클라이언트가 서버에 새로운 요청을 보낼 때 이 인증토큰을 request header에 같이 넣어서 요청함으로써 서버에서 이미 로그인한 상태라는 것을 알 수 있도록 구현합니다.

클라이언트에서 요청이 오면 서버는 response header에 Set-Cookie 헤더 값을 채워서 전송하고, 이 값은 응답을 수신하는 브라우저 쿠키에 자동으로 저장됩니다. 이 과정을 흔히 `쿠키를 굽는다.` 라고 표현합니다. 그 후 쿠키는 같은 서버에 의해 만들어진 요청들의 모든 HTTP 헤더에 포함되어 전송됩니다. 만료일과 지속시간을 명시할 수 있으며 특정 도메인 혹은 경로 제한을 통해 쿠키가 전송되는 것을 막을 수도 있습니다. 쿠키의 최대 저장 용량은 4KB입니다.

보통 세션 관리, 개인화, 트래킹에 사용되며 세션은 쿠키를 이용합니다.

- 세션 관리(Session management): 서버에 저장해야 할 로그인, 장바구니, 게임 스코어 등의 정보 관리
- 개인화(Personalization): 사용자 선호, 테마 등의 세팅
- 트래킹(Tracking): 사용자 행동을 기록하고 분석하는 용도

쿠키의 라이프 사이클

- **session cookies**: 만료일이 없고 브라우저나 탭이 열려있는 동안에만 정보가 저장됩니다. 다만 브라우저가 만료되는 시점을 정할 수 있으므로 특정 브라우저는 재시작 할 때 기존에 열려있던 세션들을 복원해서 세션 쿠키가 무기한 존재할 수 있도록 하는 경우도 있습니다.
- **persistent cookies**: 만료일이 있습니다. 명시된 날짜나 일정 기간이 지나면 삭제됩니다.

### **웹 스토리지**

쿠키의 단점을 개선하여 나온 방법으로, [동일한 출처](https://developer.mozilla.org/ko/docs/Web/Security/Same-origin_policy)(두 URL의 프로토콜(http or https), 포트(포트를 명시한 경우에만 해당), 호스트가 모두 같은 경우)에 대해 독립적인 저장 공간을 제공합니다. 쿠키는 서버가 쿠키를 설정한 이후 해당 서버와 추가적인 요청이 있을 때 무조건 데이터를 HTTP 헤더에 넣어서 전송하지만, 웹 스토리지는 브라우저에 제공되는 독립적인 저장공간이므로 서버와 데이터를 주고 받을 필요없이 브라우저에서 필요한 조건에 따라 활용이 가능합니다. 따라서 클라이언트와 서버간의 전체 트래픽과 낭비되는 대역폭의 양을 줄일 수 있으며, 최대 저장 용량이 5MB로 4KB인 쿠키보다 훨씬 큽니다.

**로컬 스토리지(localStorage) - 영구 저장소**

사용자가 사용하고 있는 브라우저의 로컬 스토리지에 데이터를 저장합니다. (같은 기기여도 브라우저가 다르면 유지되지 않습니다.) 인터넷이 끊겨도 데이터를 유지할 수 있습니다.

로컬스토리지는 자바스크립트 코드로 직접 데이터를 삭제하지 않는 한 삭제되지 않습니다. 따라서 로컬 스토리지에 중요 데이터를 저장하고 있다면, 탈취당할 가능성이 높아집니다.

**세션 스토리지(sessionStorage) - 임시 저장소**

세션 스토리지에 저장된 데이터는 웹페이지의 세션이 끝날 때 지워집니다. 브라우저의 탭마다 개별 세션이 열리고, 이 세션마다 고유한 세션 스토리지 저장소를 갖게됩니다. 그리고 이 탭이 닫히면 자동으로 해당 세션 스토리지의 내용은 소실됩니다. 새 창으로 새로운 화면을 열었을 때도 웹뷰에서 필요한 정보는 남아있어야하므로, 웹뷰 전용 데이터를 저장하기에는 적합하지 않습니다.

## **어떤 형태로 저장할 것인가?**

그렇다면 우리는 저장공간에 특정 데이터들을 어떤 형태로 저장할 수 있을까요?

### **[JSON](https://developer.mozilla.org/ko/docs/Learn/JavaScript/Objects/JSON)**

각 필드를 `key: value` 형태로 저장하는 방식이며, 암/복호화 및 코드 작성 시에 사용성이 높습니다.

```json
{
  "key1": "value1",
  "key2": "value3",
  "key3": "value3"
}
```

### **[CSV](<https://ko.wikipedia.org/wiki/CSV_(%ED%8C%8C%EC%9D%BC_%ED%98%95%EC%8B%9D)>)**

쉼표를 구분자로 사용해서 데이터를 저장하는 방식이며 문자열을 최소로 줄임으로써 용량을 적게 차지합니다.

```csv
value1,value2,value3,value4,value5
```

만약 쿠키를 사용한다면 쿠키의 저장 용량은 4KB이므로 최대한 데이터를 간단하게 유지해야합니다. 네이버 마케팅로그에서는 `_wcs`와 같은 축약형 의 이름으로 쿠키에 데이터를 저장합니다. 이렇게 축약형으로 쿠키 데이터를 저장하는 이유는 쿠키 용량을 1byte라도 줄이기 위함이며, 필드의 의미를 사용자에게 노출하지 않기 위한 전략이기도 합니다.
